<style>
  /* Windows 95 Email Client Style */
  .email-explorer {
    background: #fff;
    border: 1px solid #0054a6;
    height: calc(100vh - 120px);
    min-height: 700px;
    display: flex;
    flex-direction: column;
    box-shadow: 2px 2px 5px rgba(0,0,0,0.3);
  }

  .email-title-bar {
    background: linear-gradient(to bottom, #0997ff 0%, #0053ee 50%, #0050ee 51%, #06f 100%);
    color: white;
    padding: 4px 8px;
    font-size: 13px;
    font-weight: bold;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .email-toolbar {
    background: #f0f0f0;
    border-bottom: 1px solid #999;
    padding: 5px;
    display: flex;
    gap: 3px;
    align-items: center;
    flex-wrap: wrap;
  }

  .email-toolbar-btn {
    padding: 4px 8px;
    background: linear-gradient(to bottom, #fff 0%, #d8d8d8 100%);
    border: 1px solid #888;
    cursor: pointer;
    font-size: 11px;
    display: flex;
    align-items: center;
    gap: 4px;
    min-height: 22px;
  }

  .email-toolbar-btn:hover {
    background: linear-gradient(to bottom, #fff 0%, #c8c8c8 100%);
    border-color: #666;
  }

  .email-toolbar-btn:active {
    background: #c0c0c0;
    border-style: inset;
  }

  .email-body-container {
    display: flex;
    flex: 1;
    overflow: hidden;
    border-top: 1px solid #fff;
  }

  .email-folders-tree {
    width: 220px;
    background: white;
    border-right: 1px solid #999;
    overflow-y: auto;
    font-size: 12px;
    padding: 5px 0;
  }

  .folder-tree-item {
    padding: 4px 5px 4px 15px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 5px;
    user-select: none;
  }

  .folder-tree-item:hover {
    background: #e0e0f0;
  }

  .folder-tree-item.selected {
    background: #0a246a;
    color: white;
  }

  .email-list-panel {
    width: 450px;
    background: white;
    border-right: 1px solid #999;
    display: flex;
    flex-direction: column;
  }

  /* Compact List Style (Outlook-like) */
  .email-list-header {
    background: linear-gradient(to bottom, #fff 0%, #e8e8e8 100%);
    border-bottom: 1px solid #999;
    padding: 6px 8px;
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 11px;
  }

  .email-list-container {
    display: flex;
    flex-direction: column;
    height: 100%;
  }

  .email-items-list {
    flex: 1;
    overflow-y: auto;
  }

  .email-item {
    display: flex;
    gap: 8px;
    padding: 8px;
    border-bottom: 1px solid #e0e0e0;
    cursor: pointer;
    align-items: flex-start;
    transition: background 0.15s ease;
    border-left: 3px solid transparent;
  }

  .email-item:hover {
    background: #f0f0f0;
  }

  .email-item.selected {
    background: #e0e8ff;
    border-left-color: #90caf9;
  }

  .email-item.current {
    background: #0a246a;
    color: white;
    border-left-color: #2196F3;
  }

  .email-item.current .email-preview {
    color: #ddd;
  }

  .email-item.current .email-date {
    color: #fff;
  }

  .email-checkbox {
    margin-top: 2px;
    cursor: pointer;
  }

  .email-star {
    font-size: 14px;
    cursor: pointer;
    user-select: none;
    margin-top: 2px;
  }

  .email-content {
    flex: 1;
    min-width: 0;
  }

  .email-header-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2px;
  }

  .email-sender {
    font-weight: normal;
    font-size: 12px;
  }

  .email-item.unread .email-sender,
  .email-item.unread .email-subject {
    font-weight: bold;
  }

  .email-date {
    font-size: 11px;
    color: #666;
    white-space: nowrap;
  }

  .email-item.current .email-date {
    color: #fff;
  }

  .email-subject {
    font-size: 12px;
    margin-bottom: 2px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .email-preview {
    font-size: 11px;
    color: #666;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .bulk-actions-toolbar {
    background: #fffacd;
    border-bottom: 1px solid #999;
    padding: 5px;
    display: none;
    gap: 5px;
    align-items: center;
    font-size: 11px;
  }

  .bulk-actions-toolbar.active {
    display: flex;
  }

  .email-preview-panel {
    flex: 1;
    background: white;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  .email-preview-header {
    background: linear-gradient(to bottom, #fff 0%, #e8e8e8 100%);
    border-bottom: 1px solid #999;
    padding: 8px;
    font-size: 12px;
  }

  .email-preview-header strong {
    display: inline-block;
    width: 80px;
  }

  .email-preview-content {
    flex: 1;
    padding: 10px;
    overflow-y: auto;
    font-size: 12px;
    line-height: 1.5;
  }

  .email-statusbar {
    background: #f0f0f0;
    border-top: 1px solid #999;
    padding: 3px 8px;
    font-size: 11px;
    color: #000;
    display: flex;
    gap: 20px;
  }

  .status-item {
    padding: 0 10px;
    border-right: 1px solid #ccc;
  }

  .status-item:last-child {
    border-right: none;
  }

  /* Windows 95 Dialog Style */
  .win95-dialog {
    display: none;
    position: fixed;
    background: #c0c0c0;
    border: 2px solid;
    border-color: #fff #000 #000 #fff;
    box-shadow: 2px 2px 5px rgba(0,0,0,0.5);
    z-index: 2000;
    min-width: 400px;
    resize: both;
    overflow: auto;
  }

  .win95-dialog.active {
    display: flex;
    flex-direction: column;
  }

  .win95-dialog.compose {
    width: 600px;
    height: 500px;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
  }

  .win95-dialog.account {
    width: 450px;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
  }

  .win95-dialog-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.3);
    z-index: 1999;
  }

  .win95-dialog-overlay.active {
    display: block;
  }

  .win95-dialog-title {
    background: linear-gradient(to bottom, #0997ff 0%, #0053ee 50%, #0050ee 51%, #06f 100%);
    color: white;
    padding: 3px 5px;
    font-size: 13px;
    font-weight: bold;
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: move;
    user-select: none;
  }

  .win95-dialog-close {
    background: #c0c0c0;
    border: 2px solid;
    border-color: #fff #000 #000 #fff;
    width: 18px;
    height: 18px;
    cursor: pointer;
    font-size: 11px;
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #000;
  }

  .win95-dialog-body {
    padding: 12px;
    flex: 1;
    overflow-y: auto;
  }

  .win95-field {
    margin-bottom: 12px;
  }

  .win95-field label {
    display: block;
    margin-bottom: 3px;
    font-size: 11px;
    font-weight: bold;
  }

  .win95-field input,
  .win95-field textarea {
    width: 100%;
    padding: 3px;
    border: 2px solid;
    border-color: #808080 #fff #fff #808080;
    font-size: 11px;
    font-family: 'MS Sans Serif', Tahoma, sans-serif;
  }

  .win95-field textarea {
    resize: both;
    min-height: 250px;
    max-height: 600px;
    min-width: 100%;
  }

  .win95-dialog-buttons {
    display: flex;
    gap: 8px;
    justify-content: center;
    padding-top: 10px;
  }

  .win95-btn {
    padding: 4px 16px;
    background: #c0c0c0;
    border: 2px solid;
    border-color: #fff #000 #000 #fff;
    cursor: pointer;
    font-size: 11px;
    font-weight: bold;
    min-width: 80px;
  }

  .win95-btn:active {
    border-color: #000 #fff #fff #000;
  }

  .win95-info-box {
    background: #fff8dc;
    border: 1px solid #808080;
    padding: 8px;
    margin-top: 8px;
    font-size: 11px;
  }

  .context-menu {
    position: fixed;
    background: #f0f0f0;
    border: 1px solid #999;
    box-shadow: 2px 2px 5px rgba(0,0,0,0.3);
    z-index: 2000;
    display: none;
    min-width: 150px;
  }

  .context-menu.active {
    display: block;
  }

  .context-menu-item {
    padding: 4px 30px 4px 20px;
    font-size: 12px;
    cursor: pointer;
  }

  .context-menu-item:hover {
    background: #0a246a;
    color: white;
  }

  .context-menu-separator {
    height: 1px;
    background: #999;
    margin: 2px 0;
  }

  /* Resize Handles - Draggable dividers */
  .resize-handle {
    width: 4px;
    background: transparent;
    cursor: col-resize;
    position: relative;
    z-index: 10;
    flex-shrink: 0;
  }

  .resize-handle:hover {
    background: #0054a6;
  }

  .resize-handle.dragging {
    background: #0054a6;
  }

  /* Folder Context Menu */
  .folder-context-menu {
    position: fixed;
    background: #f0f0f0;
    border: 1px solid #999;
    box-shadow: 2px 2px 5px rgba(0,0,0,0.3);
    z-index: 2001;
    display: none;
    min-width: 180px;
  }

  .folder-context-menu.active {
    display: block;
  }

  /* Folder Picker Styles (Phase 1) */
  .folder-picker-item {
    padding: 8px 12px;
    cursor: pointer;
    border-bottom: 1px solid #e0e0e0;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .folder-picker-item:hover {
    background: #f0f0f0;
  }

  .folder-picker-item.selected {
    background: #0a246a;
    color: white;
  }
  
  /* Rich Text Editor Formatting Buttons */
  .format-btn {
    padding: 3px 8px;
    background: linear-gradient(to bottom, #fff 0%, #d8d8d8 100%);
    border: 1px solid #888;
    cursor: pointer;
    font-size: 11px;
    font-family: Arial, sans-serif;
    min-height: 22px;
  }
  
  .format-btn:hover {
    background: linear-gradient(to bottom, #fff 0%, #c8c8c8 100%);
    border-color: #666;
  }
  
  .format-btn:active {
    background: #c0c0c0;
    border-style: inset;
  }
  
  .format-btn.color-picker {
    width: 30px;
    padding: 2px;
    height: 24px;
  }
  
  /* Rich Text Editor Content */
  #compose-body[contenteditable="true"] {
    outline: none;
  }
  
  #compose-body[contenteditable="true"]:focus {
    border-color: #0054a6;
  }
</style>

<div class="email-explorer">
  <div class="email-title-bar">
    <span>📧 FlowFactory Mail</span>
  </div>

  <div class="email-toolbar">
    <button class="email-toolbar-btn" onclick="emailClient.openCompose()">✉️ Ny</button>
    <button class="email-toolbar-btn" onclick="emailClient.replyToEmail()">↩️ Svar</button>
    <button class="email-toolbar-btn" onclick="emailClient.forwardEmail()">➡️ Videresend</button>
    <button class="email-toolbar-btn" onclick="emailClient.syncEmails()">🔄 Synkroniser</button>
    <button class="email-toolbar-btn" onclick="emailClient.deleteEmail()">🗑️ Slet</button>
    <button class="email-toolbar-btn" onclick="emailClient.linkToOrder()">📦 Til ordre</button>
    <button class="email-toolbar-btn" onclick="emailClient.showAddAccountModal()">➕ Tilføj konto</button>
  </div>

  <div class="email-body-container">
    <div class="email-folders-tree">
      <div class="folder-tree-item selected" data-folder="inbox" onclick="emailClient.changeFolder('inbox')" oncontextmenu="emailClient.showFolderContextMenu(event, 'inbox')">
        📥 Indbakke <span id="inbox-count">(0)</span>
      </div>
      <div class="folder-tree-item" data-folder="starred" onclick="emailClient.changeFolder('starred')" oncontextmenu="emailClient.showFolderContextMenu(event, 'starred')">
        ⭐ Markerede <span id="starred-count">(0)</span>
      </div>
      <div class="folder-tree-item" data-folder="sent" onclick="emailClient.changeFolder('sent')" oncontextmenu="emailClient.showFolderContextMenu(event, 'sent')">
        📤 Sendt
      </div>
      <div class="folder-tree-item" data-folder="drafts" onclick="emailClient.changeFolder('drafts')" oncontextmenu="emailClient.showFolderContextMenu(event, 'drafts')">
        📝 Kladder <span id="drafts-count">(0)</span>
      </div>
      <hr style="border: none; border-top: 1px solid #ccc; margin: 5px 0;">
      <div style="padding: 5px 10px; font-weight: bold; font-size: 11px;">Email konti:</div>
      <div id="email-accounts-list"></div>
      <div id="custom-folders-list"></div>
    </div>

    <!-- Resize Handle 1: Between folders and list -->
    <div class="resize-handle" data-resize="folders"></div>

    <div class="email-list-panel">
      <!-- Bulk Actions Toolbar -->
      <div class="bulk-actions-toolbar" id="bulk-actions-toolbar">
        <span id="bulk-selected-count">0 valgt</span>
        <button class="email-toolbar-btn" onclick="emailClient.deleteBulkEmails()" style="margin-left: auto;">🗑️ Slet valgte</button>
        <button class="email-toolbar-btn" onclick="emailClient.starBulkEmails()">⭐ Marker valgte</button>
        <button class="email-toolbar-btn" onclick="emailClient.clearSelection()">✕ Ryd</button>
      </div>

      <div class="email-list-container">
        <!-- Select All Header -->
        <div class="email-list-header">
          <input type="checkbox" id="select-all-checkbox" onchange="emailClient.toggleSelectAll()" />
          <label for="select-all-checkbox" style="cursor: pointer;">Vælg alle</label>
        </div>

        <!-- Email Items List -->
        <div class="email-items-list" id="emails-list">
          <div style="text-align: center; padding: 40px; color: #999;">Ingen emails</div>
        </div>

        <!-- Load More Button Container -->
        <div id="load-more-container" style="display: none; text-align: center; padding: 15px; border-top: 1px solid #ccc;">
          <!-- Dynamically populated by emailClient.updateLoadMoreButton() -->
        </div>
      </div>
    </div>

    <!-- Resize Handle 2: Between list and preview -->
    <div class="resize-handle" data-resize="list"></div>

    <div class="email-preview-panel" id="email-preview">
      <div style="display: flex; align-items: center; justify-content: center; height: 100%; color: #999;">
        Vælg en email for at læse den
      </div>
    </div>
  </div>

  <div class="email-statusbar">
    <span class="status-item" id="status-emails">0 emails</span>
    <span class="status-item" id="status-account">Ingen konto valgt</span>
  </div>
</div>

<!-- Compose Dialog - Enhanced -->
<div class="win95-dialog-overlay" id="compose-overlay"></div>
<div class="win95-dialog" id="compose-dialog" style="width: 700px; height: 650px;">
  <div class="win95-dialog-title" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
    <span>✉️ Ny Email</span>
    <button class="win95-dialog-close" onclick="emailClient.closeCompose()">✕</button>
  </div>
  <div class="win95-dialog-body" style="padding: 15px;">
    <div class="win95-field">
      <label>📧 Til:</label>
      <input type="email" id="compose-to" placeholder="modtager@example.com" onkeyup="emailClient.autoSaveDraft()">
    </div>
    
    <!-- CC/BCC Fields (Hidden by default) -->
    <div id="cc-bcc-fields" style="display: none;">
      <div class="win95-field">
        <label>📧 CC (Kopi):</label>
        <input type="email" id="compose-cc" placeholder="cc@example.com" onkeyup="emailClient.autoSaveDraft()">
      </div>
      <div class="win95-field">
        <label>🔒 BCC (Skjult kopi):</label>
        <input type="email" id="compose-bcc" placeholder="bcc@example.com" onkeyup="emailClient.autoSaveDraft()">
      </div>
    </div>
    
    <div class="win95-field">
      <label>📝 Emne:</label>
      <input type="text" id="compose-subject" placeholder="Email emne" onkeyup="emailClient.autoSaveDraft()">
    </div>
    
    <div style="margin-bottom: 10px;">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
        <label style="font-weight: bold;">💬 Besked:</label>
        <button onclick="emailClient.toggleCcBcc()" class="format-btn" style="font-size: 10px;">CC/BCC</button>
      </div>
      
      <!-- Formatting Toolbar -->
      <div class="formatting-toolbar" style="display: flex; gap: 5px; padding: 5px; background: #f0f0f0; border: 1px solid #ccc; border-bottom: none; flex-wrap: wrap;">
          <!-- Font Family -->
          <select onchange="emailClient.formatText('fontName', this.value)" class="format-btn" title="Skrifttype">
            <option value="">Skrifttype</option>
            <option value="Arial">Arial</option>
            <option value="Times New Roman">Times New Roman</option>
            <option value="Courier New">Courier New</option>
            <option value="Georgia">Georgia</option>
            <option value="Verdana">Verdana</option>
            <option value="Comic Sans MS">Comic Sans MS</option>
          </select>
          
          <!-- Font Size -->
          <select onchange="emailClient.formatText('fontSize', this.value)" class="format-btn" title="Skriftstørrelse">
            <option value="">Størrelse</option>
            <option value="1">8pt</option>
            <option value="2">10pt</option>
            <option value="3">12pt</option>
            <option value="4">14pt</option>
            <option value="5">18pt</option>
            <option value="6">24pt</option>
            <option value="7">36pt</option>
          </select>
          
          <!-- Basic Formatting -->
          <button onclick="emailClient.formatText('bold')" class="format-btn" title="Fed (Ctrl+B)"><strong>B</strong></button>
          <button onclick="emailClient.formatText('italic')" class="format-btn" title="Kursiv (Ctrl+I)"><em>I</em></button>
          <button onclick="emailClient.formatText('underline')" class="format-btn" title="Understreget (Ctrl+U)"><u>U</u></button>
          
          <div style="width: 1px; height: 20px; background: #999; margin: 0 3px;"></div>
          
          <!-- Text Color -->
          <input type="color" id="text-color-picker" onchange="emailClient.formatText('foreColor', this.value)" class="format-btn color-picker" title="Tekstfarve" value="#000000">
          <input type="color" id="bg-color-picker" onchange="emailClient.formatText('hiliteColor', this.value)" class="format-btn color-picker" title="Baggrundsfarve" value="#ffff00">
          
          <div style="width: 1px; height: 20px; background: #999; margin: 0 3px;"></div>
          
          <!-- Alignment -->
          <button onclick="emailClient.formatText('justifyLeft')" class="format-btn" title="Venstrejusteret">≡</button>
          <button onclick="emailClient.formatText('justifyCenter')" class="format-btn" title="Centreret">≡</button>
          <button onclick="emailClient.formatText('justifyRight')" class="format-btn" title="Højrejusteret">≡</button>
          
          <div style="width: 1px; height: 20px; background: #999; margin: 0 3px;"></div>
          
          <!-- Lists -->
          <button onclick="emailClient.formatText('insertUnorderedList')" class="format-btn" title="Punktliste">• Liste</button>
          <button onclick="emailClient.formatText('insertOrderedList')" class="format-btn" title="Nummereret liste">1. Liste</button>
          
          <div style="width: 1px; height: 20px; background: #999; margin: 0 3px;"></div>
          
          <!-- Link -->
          <button onclick="emailClient.insertLink()" class="format-btn" title="Indsæt link">🔗 Link</button>
          
          <!-- Clear Formatting -->
          <button onclick="emailClient.formatText('removeFormat')" class="format-btn" title="Fjern formatering">✖ Ryd</button>
        </div>
        
        <!-- Rich Text Editor -->
        <div id="compose-body" 
             contenteditable="true"
             oninput="emailClient.autoSaveDraft()"
             style="width: 100%; min-height: 200px; max-height: 400px; overflow-y: auto; padding: 8px; font-family: Arial, sans-serif; font-size: 13px; border: 1px solid #ccc; background: white;"></div>
        
        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 5px; font-size: 11px; color: #666;">
          <span id="char-count">0 tegn</span>
          <div id="draft-notice" style="display: none; color: #0a246a;">✓ Kladde gemt</div>
        </div>
      </div>
    
    <!-- File Attachments -->
    <div class="win95-field">
      <label>📎 Vedhæft filer:</label>
      <input type="file" id="compose-files" multiple style="font-size: 11px;" onchange="emailClient.handleFileSelect()">
      <div id="attachment-list" style="margin-top: 5px; font-size: 11px;"></div>
      </div>
    </div>
    
    <!-- Signature Toggle -->
    <div style="margin-bottom: 10px;">
      <label style="font-size: 11px;">
        <input type="checkbox" id="include-signature" checked onchange="emailClient.updateSignaturePreview()"> 
        Inkluder signatur
      </label>
      <a href="#" onclick="emailClient.editSignature(); return false;" style="font-size: 11px; margin-left: 10px; color: #0000ee;">⚙️ Redigér signatur</a>
    </div>
    
    <div class="win95-dialog-buttons" style="margin-top: 15px;">
      <button class="win95-btn" onclick="emailClient.sendEmail()">📤 Send</button>
      <button class="win95-btn" onclick="emailClient.saveDraft()">💾 Gem kladde</button>
      <button class="win95-btn" onclick="emailClient.closeCompose()">❌ Annuller</button>
    </div>
    
    <div id="draft-notice" style="display: none; background: #fffacd; padding: 5px; margin-top: 10px; font-size: 11px; border: 1px solid #ccc;">
      📝 Kladde gemt automatisk
    </div>
  </div>
</div>

<!-- Signature Editor Dialog -->
<div class="win95-dialog-overlay" id="signature-overlay"></div>
<div class="win95-dialog" id="signature-dialog" style="width: 500px;">
  <div class="win95-dialog-title" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
    <span>✍️ Redigér Email Signatur</span>
    <button class="win95-dialog-close" onclick="emailClient.closeSignatureEditor()">✕</button>
  </div>
  <div class="win95-dialog-body">
    <div class="win95-field">
      <label>Din signatur:</label>
      <textarea id="signature-text" style="min-height: 150px;" placeholder="Med venlig hilsen,&#10;Dit Navn&#10;Din Stilling&#10;Telefon: +45 12 34 56 78"></textarea>
    </div>
    <div class="win95-info-box">
      💡 Signaturen tilføjes automatisk til dine emails. Du kan slå den fra ved at fjerne fluebenet "Inkluder signatur".
    </div>
    <div class="win95-dialog-buttons">
      <button class="win95-btn" onclick="emailClient.saveSignature()">💾 Gem</button>
      <button class="win95-btn" onclick="emailClient.closeSignatureEditor()">Annuller</button>
    </div>
  </div>
</div>

<!-- Add Account Dialog -->
<div class="win95-dialog-overlay" id="account-overlay" onclick="emailClient.closeAddAccountModal()"></div>
<div class="win95-dialog" id="account-dialog">
  <div class="win95-dialog-title">
    <span>Tilføj Email Konto</span>
    <button class="win95-dialog-close" onclick="emailClient.closeAddAccountModal()">✕</button>
  </div>
  <div class="win95-dialog-body">
    <div class="win95-field">
      <label>Email:</label>
      <input type="email" id="account-email" placeholder="din@email.dk">
    </div>
    <div class="win95-field">
      <label>Password:</label>
      <input type="password" id="account-password" placeholder="••••••••">
    </div>
    <div class="win95-field">
      <label>IMAP Host:</label>
      <input type="text" id="account-imap-host" placeholder="imap.gmail.com" value="imap.gmail.com">
    </div>
    <div class="win95-field">
      <label>IMAP Port:</label>
      <input type="number" id="account-imap-port" value="993">
    </div>
    <div class="win95-field">
      <label>SMTP Host:</label>
      <input type="text" id="account-smtp-host" placeholder="smtp.gmail.com" value="smtp.gmail.com">
    </div>
    <div class="win95-field">
      <label>SMTP Port:</label>
      <input type="number" id="account-smtp-port" value="587">
    </div>
    <div class="win95-info-box">
      <strong>💡 Sådan tilføjer du Gmail:</strong><br><br>
      <strong>1. Email:</strong> Din Gmail adresse (f.eks. dit.navn@gmail.com)<br><br>
      <strong>2. Password:</strong> IKKE dit normale Gmail password!<br>
      &nbsp;&nbsp;&nbsp;→ Opret "App Password" sådan:<br>
      &nbsp;&nbsp;&nbsp;→ Gå til https://myaccount.google.com/security<br>
      &nbsp;&nbsp;&nbsp;→ Slå "2-Step Verification" til (hvis ikke aktiveret)<br>
      &nbsp;&nbsp;&nbsp;→ Klik "App passwords" (nederst på siden)<br>
      &nbsp;&nbsp;&nbsp;→ Vælg "Mail" og "Other device"<br>
      &nbsp;&nbsp;&nbsp;→ Google viser et 16-tegns password<br>
      &nbsp;&nbsp;&nbsp;→ Kopiér dette password og brug det her!<br><br>
      <strong>3. IMAP/SMTP er allerede udfyldt korrekt for Gmail</strong>
    </div>
    <div class="win95-dialog-buttons">
      <button class="win95-btn" onclick="emailClient.addEmailAccountFromModal()">Tilføj</button>
      <button class="win95-btn" onclick="emailClient.closeAddAccountModal()">Annuller</button>
    </div>
  </div>
</div>

<!-- Folder Picker Dialog (Phase 1) -->
<div class="win95-dialog-overlay" id="folder-picker-overlay" onclick="emailClient.closeFolderPicker()"></div>
<div class="win95-dialog" id="folder-picker-dialog" style="width: 400px;">
  <div class="win95-dialog-title">
    <span>Flyt til mappe</span>
    <button class="win95-dialog-close" onclick="emailClient.closeFolderPicker()">✕</button>
  </div>
  <div class="win95-dialog-body">
    <div style="max-height: 300px; overflow-y: auto; margin-bottom: 15px;" id="folder-picker-list">
      <!-- Folders rendered here -->
    </div>
    <div class="win95-dialog-buttons">
      <button class="win95-btn" onclick="emailClient.moveEmailToSelectedFolder()">Flyt</button>
      <button class="win95-btn" onclick="emailClient.closeFolderPicker()">Annuller</button>
    </div>
  </div>
</div>

<!-- Email Context Menu -->
<div class="context-menu" id="context-menu">
  <div class="context-menu-item" onclick="emailClient.linkToOrder()">📦 Send til ordre</div>
  <div class="context-menu-separator"></div>
  <div class="context-menu-item" onclick="emailClient.showFolderPicker()">📁 Flyt til mappe</div>
  <div class="context-menu-item" onclick="emailClient.toggleStar()">⭐ Marker email</div>
  <div class="context-menu-item" onclick="emailClient.deleteEmail()">🗑️ Slet email</div>
</div>

<!-- Folder Context Menu -->
<div class="folder-context-menu" id="folder-context-menu">
  <div class="context-menu-item" onclick="emailClient.createNewFolder()">📁 Opret ny mappe</div>
  <div class="context-menu-item" onclick="emailClient.renameFolder()">✏️ Omdøb mappe</div>
  <div class="context-menu-item" onclick="emailClient.deleteFolder()">🗑️ Slet mappe</div>
  <div class="context-menu-separator"></div>
  <div class="context-menu-item" onclick="emailClient.markAllAsRead()">✅ Marker alle som læst</div>
</div>

<script src="js/email.js"></script>
